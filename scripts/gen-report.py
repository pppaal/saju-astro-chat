# -*- coding: utf-8 -*-
import sys
sys.stdout.reconfigure(encoding='utf-8')

from openai import OpenAI

client = OpenAI(api_key='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')

prompt = '''당신은 Destiny Fusion Matrix 전문가입니다.
동양 사주와 서양 점성술을 50:50 비율로 융합하여 해석하세요.
아래 10레이어 데이터를 모두 활용해서 오늘을 알려주세요.

【핵심 규칙】
- 리스트, 점수표, 이모지 절대 금지
- 소설체 금지
- 친구한테 말하듯이 현실적으로
- 사주와 점성술을 번갈아가며 융합 해석
- 모든 레이어 데이터를 자연스럽게 녹여서
- 1200~1500자

═══════════════════════════════════════════════════════════════
            DESTINY FUSION MATRIX™ 10-LAYER 분석 데이터
═══════════════════════════════════════════════════════════════

【Layer 1: 사주 원국】
일간: 갑목(甲木) - 큰 나무, 성장 지향적, 곧은 성격
월간: 기토(己土) - 부드러운 흙, 포용력
격국: 식신격 - 창의력과 말빨이 핵심 능력
용신: 수(水) - 물 에너지 필요

【Layer 2: 십신 분포】
식신 2개 - 아이디어 뱅크, 표현력 갑
정관 2개 - 책임감 강함, 조직에서 믿음직함
편인 1개 - 독특한 시각, 남다른 생각
재성 0개 - 돈보다 의미 추구

【Layer 3: 오행 밸런스】
목 35% (과다) - 자기주장 강함, 고집 좀 있음
화 20% (보통) - 열정 적당히 있음
토 15% (부족) - 현실감각 좀 약함
금 10% (부족) - 결단력 키워야 함
수 20% (보통) - 지혜와 유연함

【Layer 4: 신살】
도화살 - 이성한테 자연스레 끌림
역마살 - 변화/이동 에너지 강함
문창귀인 - 글쓰기/학문 재능 타고남
천을귀인 - 위기 때 도움의 손길

【Layer 5: 대운 (32~42세)】
경오대운 - 금+화 시기
금극목 - 시련으로 강해지는 10년
지금 딱 중간 지점

【Layer 6: 세운 2026년】
병오년 - 화의 해
목생화 - 그동안 준비한 게 빛 보는 해
표현하고 드러나는 시기

【Layer 7: 월운 1월】
기축월 - 토의 달
목극토 - 주도권 잡는 달
너무 밀면 반발 있음

【Layer 8: 일진 오늘 1/21】
계묘일 - 수+목
수생목 - 아이디어 폭발하는 날
묘목 비견 - 동료/친구 협력 대박

【Layer 9: 출생 차트 (Natal Chart)】
태양 황소자리 25도 - 안정 추구, 감각형, 고집 있음, 돈/물질 민감
달 물병자리 12도 - 독립적, 혁신적, 감정 드라이, 자유 중시
수성 쌍둥이자리 8도 - 말 빠름, 재치, 호기심 많음, 정보통
금성 양자리 18도 - 사랑 직진형, 열정적, 즉흥적
화성 사자자리 22도 - 자존심 강함, 리더십, 주목받길 원함
목성 게자리 5도 - 가족/집 중시, 감성 풍부, 확장적
토성 염소자리 16도 - 책임감, 현실적, 커리어 중시

상승궁: 쌍둥이자리 - 첫인상 밝고 말 잘함
MC: 물고기자리 - 예술/창의/영적 커리어 적합
IC: 처녀자리 - 집에선 꼼꼼하고 정리 잘함
하강궁: 사수자리 - 파트너는 자유롭고 모험적인 사람

【Layer 10: 오늘의 트랜싯 (Transit)】
태양 물병자리 1도 - 혁신적 에너지
달 천칭자리 - 인간관계/소통 중심
수성 염소자리 - 현실적 커뮤니케이션
금성 물고기자리 - 감성적 사랑 에너지
화성 양자리 28도 - 추진력 최고조
목성 쌍둥이자리 - 학습/소통 확장

주요 배치:
- 금성-목성 트라인 (120도) - 인간관계 대박
- 화성-태양 섹스타일 (60도) - 행동력 상승
- 달-금성 조화 - 감정 안정

═══════════════════════════════════════════════════════════════

위 10레이어 데이터를 전부 활용해서 오늘을 풀어줘.
사주와 점성술을 골고루 섞어서, 마치 이 두 개가 서로 대화하듯이.
예: "사주로 보면 수생목이라 아이디어가 샘솟고, 점성술로도 금성-목성 트라인이라 인간관계가 술술 풀리는 날이야"

친구한테 카톡하듯 편하게, 근데 전문적으로.
'''

response = client.chat.completions.create(
    model='gpt-4o',
    messages=[{'role': 'user', 'content': prompt}],
    max_tokens=2200,
    temperature=0.8
)

print(response.choices[0].message.content)
